{% load crispy_forms_tags %}
<div id="review" class="tab-pane">
  <!-- Reviews Start -->
    {% for comment in product.get_comments %}
    <h4 class="review-mini-title">{{ comment.author }}</h4>
      <div class="single-comment">
        <div class="comment-details fix">
          <span>{{ comment.created }}</span>
          <p>{{ comment.text | linebreaksbr }}</p>
        </div>
        <a class="reply" href="#formComment" onclick="addComment('{{ comment.author }}', '{{ comment.id }}')">ответить</a>
        </div>
        {% for cmt in comment.comment_set.all %}
          <div class="review ml-5">
            <h4 class="review-mini-title">{{ cmt.author }}</h4>
            <div class="single-comment">
              <div class="comment-details">
                <span>{{ cmt.created }}</span>
                <p>{{ cmt.text }}</p>
              </div>
            </div>
          </div>
        {% endfor %}
      
    {% empty %}
      <p>Пока нет отзывов.</p>
    {% endfor %}
<br/>
    <form method="post" action="{% url 'new_comment_product' product.pk product.slug %}" id="formComment">
      <input type="hidden" name="parent" id="contactparent" value="">
      <div class="form-group">
          <input type="hidden" value="{{ product.id }}" name="product">
          <span class="rating">
              {% for k, v in star_form.fields.star.choices %}
                  <input id="rating{{ v }}" type="radio" name="star"
                         value="{{ k }}">
                  <label for="rating{{ v }}">{{ k }}</label>
              {% endfor %}
          </span>
          {{ form|crispy }}
          {% csrf_token %}
      </div>
      <button type="submit" class="btn-submit">Отправить отзыв</button>
    </form>

    </div>
  <div>
</div>
<script>
function addComment(author, id){
  document.getElementById('contactparent').value = id;
  document.getElementById('id_text').innerText = `${author}, `
}
</script>
